/* AGARD 445 wing */

// Mesh parameters
// domain and mesh
DefineConstant[ nC = { 50, Name "Number of panel along chord" }
                nS = { 10, Name "Number of panel along span" }
                bC = { 1.0, Name "Progression along chord" }
                pS = { 1.0, Name "Progression along span" } ];

//// GEOMETRY
/// Points
// Airfoil 1: agard445, 51 points 
Point(1) = {0.559000,0.000000,0.000000};
Point(2) = {0.531050,0.000000,0.001398};
Point(3) = {0.503100,0.000000,0.002739};
Point(4) = {0.475150,0.000000,0.004075};
Point(5) = {0.447200,0.000000,0.005406};
Point(6) = {0.419250,0.000000,0.006680};
Point(7) = {0.391300,0.000000,0.007837};
Point(8) = {0.363350,0.000000,0.008866};
Point(9) = {0.335400,0.000000,0.009743};
Point(10) = {0.307450,0.000000,0.010442};
Point(11) = {0.279500,0.000000,0.010923};
Point(12) = {0.251550,0.000000,0.011158};
Point(13) = {0.223600,0.000000,0.011163};
Point(14) = {0.195650,0.000000,0.010968};
Point(15) = {0.167700,0.000000,0.010576};
Point(16) = {0.139750,0.000000,0.009995};
Point(17) = {0.111800,0.000000,0.009196};
Point(18) = {0.083850,0.000000,0.008156};
Point(19) = {0.055900,0.000000,0.006781};
Point(20) = {0.041925,0.000000,0.005920};
Point(21) = {0.027950,0.000000,0.004891};
Point(22) = {0.013975,0.000000,0.003617};
Point(23) = {0.006988,0.000000,0.002622};
Point(24) = {0.004193,0.000000,0.002057};
Point(25) = {0.002795,0.000000,0.001699};
Point(26) = {0.000000,0.000000,0.000000};
Point(27) = {0.002795,0.000000,-0.001699};
Point(28) = {0.004193,0.000000,-0.002057};
Point(29) = {0.006988,0.000000,-0.002622};
Point(30) = {0.013975,0.000000,-0.003617};
Point(31) = {0.027950,0.000000,-0.004891};
Point(32) = {0.041925,0.000000,-0.005920};
Point(33) = {0.055900,0.000000,-0.006781};
Point(34) = {0.083850,0.000000,-0.008156};
Point(35) = {0.111800,0.000000,-0.009196};
Point(36) = {0.139750,0.000000,-0.009995};
Point(37) = {0.167700,0.000000,-0.010576};
Point(38) = {0.195650,0.000000,-0.010968};
Point(39) = {0.223600,0.000000,-0.011163};
Point(40) = {0.251550,0.000000,-0.011158};
Point(41) = {0.279500,0.000000,-0.010923};
Point(42) = {0.307450,0.000000,-0.010442};
Point(43) = {0.335400,0.000000,-0.009743};
Point(44) = {0.363350,0.000000,-0.008866};
Point(45) = {0.391300,0.000000,-0.007837};
Point(46) = {0.419250,0.000000,-0.006680};
Point(47) = {0.447200,0.000000,-0.005406};
Point(48) = {0.475150,0.000000,-0.004075};
Point(49) = {0.503100,0.000000,-0.002739};
Point(50) = {0.531050,0.000000,-0.001398};
// Airfoil 2: agard445, 51 points 
Point(52) = {1.178128,0.762000,0.000000};
Point(53) = {1.159709,0.762000,0.000921};
Point(54) = {1.141290,0.762000,0.001805};
Point(55) = {1.122870,0.762000,0.002685};
Point(56) = {1.104451,0.762000,0.003562};
Point(57) = {1.086032,0.762000,0.004402};
Point(58) = {1.067613,0.762000,0.005165};
Point(59) = {1.049194,0.762000,0.005843};
Point(60) = {1.030775,0.762000,0.006421};
Point(61) = {1.012356,0.762000,0.006881};
Point(62) = {0.993937,0.762000,0.007198};
Point(63) = {0.975518,0.762000,0.007353};
Point(64) = {0.957099,0.762000,0.007357};
Point(65) = {0.938680,0.762000,0.007228};
Point(66) = {0.920261,0.762000,0.006970};
Point(67) = {0.901842,0.762000,0.006587};
Point(68) = {0.883423,0.762000,0.006060};
Point(69) = {0.865004,0.762000,0.005375};
Point(70) = {0.846585,0.762000,0.004468};
Point(71) = {0.837375,0.762000,0.003901};
Point(72) = {0.828166,0.762000,0.003223};
Point(73) = {0.818956,0.762000,0.002383};
Point(74) = {0.814351,0.762000,0.001728};
Point(75) = {0.812509,0.762000,0.001356};
Point(76) = {0.811589,0.762000,0.001120};
Point(77) = {0.809747,0.762000,0.000000};
Point(78) = {0.811589,0.762000,-0.001120};
Point(79) = {0.812509,0.762000,-0.001356};
Point(80) = {0.814351,0.762000,-0.001728};
Point(81) = {0.818956,0.762000,-0.002383};
Point(82) = {0.828166,0.762000,-0.003223};
Point(83) = {0.837375,0.762000,-0.003901};
Point(84) = {0.846585,0.762000,-0.004468};
Point(85) = {0.865004,0.762000,-0.005375};
Point(86) = {0.883423,0.762000,-0.006060};
Point(87) = {0.901842,0.762000,-0.006587};
Point(88) = {0.920261,0.762000,-0.006970};
Point(89) = {0.938680,0.762000,-0.007228};
Point(90) = {0.957099,0.762000,-0.007357};
Point(91) = {0.975518,0.762000,-0.007353};
Point(92) = {0.993937,0.762000,-0.007198};
Point(93) = {1.012356,0.762000,-0.006881};
Point(94) = {1.030775,0.762000,-0.006421};
Point(95) = {1.049194,0.762000,-0.005843};
Point(96) = {1.067613,0.762000,-0.005165};
Point(97) = {1.086032,0.762000,-0.004402};
Point(98) = {1.104451,0.762000,-0.003562};
Point(99) = {1.122870,0.762000,-0.002685};
Point(100) = {1.141290,0.762000,-0.001805};
Point(101) = {1.159709,0.762000,-0.000921};

/// Lines
// Airfoil 1:
Spline(1) = {1:26};
Spline(2) = {26:50,1};
// Airfoil 2:
Spline(3) = {52:77};
Spline(4) = {77:101,52};
// Airfoil 1 to airfoil 2:
Line(61) = {1,52};
Line(62) = {26,77};


/// Line loops & Surfaces
// Wing 1:
Line Loop(11) = {1,62,-3,-61};
Line Loop(12) = {2,61,-4,-62};
Surface(11) = {-11};
Surface(12) = {-12};

//// MESH
Transfinite Line{1,2,3,4} = nC + 1 Using Bump bC;
Transfinite Line{61,62} = nS + 1 Using Progression pS;
Transfinite Surface{11,12};
Recombine Surface{11,12};

//// PHYSICAL GROUPS
// Trailing edge
Physical Line("te") = {61};
// Wing:
Physical Surface("wing") = {11,12};
